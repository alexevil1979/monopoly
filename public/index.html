<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monopoly Online ‚Äî Premium Edition</title>
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Crect width='32' height='32' fill='%232d8659' rx='4'/%3E%3Ccircle cx='16' cy='16' r='6' fill='%23fff'/%3E%3C/svg%3E" />
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/css/themes.css" />
  <link rel="stylesheet" href="/css/atmosphere.css" />
  <link rel="stylesheet" href="/css/animations.css" />
</head>
<body data-hall-theme="america50">
  <script>
    (function(){var t=localStorage.getItem('monopolyHallTheme')||'america50';if(['america50','classic','artdeco','scandinavian','wood','neon','luxury'].indexOf(t)!==-1){document.body.setAttribute('data-hall-theme',t);}})();
  </script>
  <!-- Theme Toggle -->
  <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="5"></circle>
      <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
    </svg>
  </button>

  <!-- Loading Spinner -->
  <div class="loading-spinner" id="loadingSpinner">
    <div class="spinner"></div>
  </div>

  <!-- Reconnect Overlay -->
  <div class="reconnect-overlay" id="reconnectOverlay">
    <div class="spinner"></div>
    <div class="reconnect-message" data-i18n="reconnect">Reconnecting...</div>
  </div>

  <!-- Confetti Container -->
  <div class="confetti-container" id="confettiContainer"></div>

  <!-- Lobby Screen -->
  <div id="lobbyScreen" class="screen active">
    <div class="lobby-container">
      <div class="lobby">
        <h1 data-i18n="lobby_title">Monopoly Online</h1>
        <p data-i18n="lobby_subtitle">Create or join a game room</p>

        <div class="lobby-input-group">
          <label for="langSelect">Language / –Ø–∑—ã–∫</label>
          <select id="langSelect" class="lobby-select" aria-label="Language">
            <option value="en">English</option>
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            <option value="zh">‰∏≠Êñá</option>
            <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
            <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
          </select>
        </div>
        
        <div class="lobby-input-group">
          <label for="playerName" data-i18n="your_name">Your Name</label>
          <input type="text" id="playerName" data-i18n-placeholder="enter_name" placeholder="Enter your name" value="Player" maxlength="20" />
        </div>

        <button id="btnCreate" class="action-btn primary" data-i18n="create_room">Create Room</button>
        
        <div style="text-align: center; margin: 24px 0; color: var(--text-secondary);" data-i18n="or">or</div>
        
        <div class="lobby-input-group">
          <label for="joinCode" data-i18n="room_code">Room Code</label>
          <input type="text" id="joinCode" data-i18n-placeholder="enter_code" placeholder="Enter room code" maxlength="6" style="text-transform: uppercase; font-family: monospace; letter-spacing: 4px;" />
        </div>

        <button id="btnJoin" class="action-btn secondary" data-i18n="join_room">Join Room</button>

        <div class="lobby-input-group" style="margin-top: 28px; padding-top: 20px; border-top: 1px solid var(--border-color);">
          <label data-i18n="hall_theme">Hall theme</label>
          <div class="theme-picker" id="themePicker" role="group" aria-label="–í—ã–±–æ—Ä —Ç–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è">
            <button type="button" class="theme-picker-btn active" data-hall-theme="america50" title="America 50s">üá∫üá∏ 50s</button>
            <button type="button" class="theme-picker-btn" data-hall-theme="classic" title="Classic Monopoly">üé≤ Classic</button>
            <button type="button" class="theme-picker-btn" data-hall-theme="artdeco" title="Art Deco">‚ú® Art Deco</button>
            <button type="button" class="theme-picker-btn" data-hall-theme="scandinavian" title="Scandinavian">üå≤ Nordic</button>
            <button type="button" class="theme-picker-btn" data-hall-theme="wood" title="Wood">ü™µ Wood</button>
            <button type="button" class="theme-picker-btn" data-hall-theme="neon" title="Neon">üåÉ Neon</button>
            <button type="button" class="theme-picker-btn" data-hall-theme="luxury" title="Luxury Art Deco">üëë Luxury</button>
          </div>
        </div>
        
        <p id="lobbyError" class="error" style="display: none;"></p>
      </div>
    </div>
  </div>

  <!-- Room Screen -->
  <div id="roomScreen" class="screen">
    <div class="room-header">
      <h2><span data-i18n="room_code">Room</span>: <span id="roomCode" style="font-family: monospace; letter-spacing: 4px; color: var(--accent-gold);"></span></h2>
      <p style="color: var(--text-secondary); margin-top: 8px;" data-i18n="share_code">Share this code with your friends</p>
    </div>
    
    <div class="players" id="playersList"></div>
    
    <div id="lobbyActions" style="text-align: center; margin-top: 32px;">
      <button id="btnReady" class="action-btn primary" data-i18n="ready">I'm Ready</button>
      <p id="roomStatus" class="status" style="margin-top: 16px; padding: 16px; background: var(--bg-glass); border-radius: 12px; color: var(--text-secondary);" data-i18n="room_status_wait">
        Waiting for players. Click "I'm ready" when everyone has joined.
      </p>
    </div>
    
    <p id="roomError" class="error" style="display: none;"></p>
  </div>

  <!-- Game Screen -->
  <div id="gameScreen" class="screen">
    <!-- Board Container -->
    <div class="board-container">
      <div class="board-wrapper">
        <div class="board-circle" id="boardCircle">
          <div class="board-center">
            <div class="board-logo" aria-label="MAXIPOLY">MAXIPOLY</div>
          </div>
          <div id="board" class="board-cells"></div>
        </div>
      </div>
    </div>

    <!-- Players Panel -->
    <div class="players-panel" id="playersPanel">
      <!-- Players will be rendered here -->
    </div>

    <!-- Game HUD -->
    <div class="game-hud">
      <div class="hud-status" id="gameStatus" aria-live="polite" aria-atomic="true" data-i18n="waiting_start">Waiting for game to start...</div>
      
      <div class="dice-container" id="diceContainer" style="display: none;">
        <div class="dice" id="dice1">üé≤</div>
        <div class="dice" id="dice2">üé≤</div>
      </div>
      
      <div class="game-actions" id="gameActions"></div>
      
      <p id="gameError" class="error" style="display: none;"></p>
    </div>
  </div>

  <!-- Modals -->
  
  <!-- Property Modal (–∫–∞—Ä—Ç–æ—á–∫–∞: —Ñ–æ—Ç–æ, –æ–ø–∏—Å–∞–Ω–∏–µ, —Ü–µ–Ω–∞/–¥–µ–π—Å—Ç–≤–∏—è) -->
  <div class="modal-overlay" id="propertyModal">
    <div class="modal modal-card">
      <div class="modal-header">
        <h3 id="propertyModalTitle" data-i18n="property">Property</h3>
      </div>
      <div class="modal-body">
        <div class="card-modal-image-wrap">
          <img id="propertyModalImage" class="card-modal-image" src="" alt="" />
        </div>
        <p id="propertyModalDescription" class="card-modal-description"></p>
        <div id="propertyModalContent" class="card-modal-details"></div>
      </div>
      <div class="modal-footer">
        <button class="action-btn secondary" id="propertyModalClose" data-i18n="close">Close</button>
      </div>
    </div>
  </div>

  <!-- Chance/Community Chest Card Modal -->
  <div class="modal-overlay" id="cardModal">
    <div class="modal">
      <div class="card-flip" id="cardFlip">
        <div class="card-flip-inner">
          <div class="card-flip-front">
            <h3 id="cardModalType">Chance</h3>
          </div>
          <div class="card-flip-back">
            <h3 id="cardModalTitle">Card Title</h3>
            <p id="cardModalText">Card text goes here</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bankrupt Modal -->
  <div class="modal-overlay" id="bankruptModal">
    <div class="modal">
      <div class="modal-header">
        <h3 style="color: #ff6b6b;" data-i18n="bankrupt">üí∏ Bankrupt!</h3>
      </div>
      <div class="modal-body">
        <p id="bankruptModalText" data-i18n="bankrupt_text">You have gone bankrupt!</p>
      </div>
      <div class="modal-footer">
        <button class="action-btn neutral" id="bankruptModalClose" data-i18n="continue_btn">Continue</button>
      </div>
    </div>
  </div>

  <!-- Win Modal -->
  <div class="modal-overlay" id="winModal">
    <div class="modal">
      <div class="modal-header">
        <h3 style="color: var(--accent-gold); font-size: 2.5rem;" data-i18n="victory">üéâ Victory!</h3>
      </div>
      <div class="modal-body">
        <p id="winModalText" style="font-size: 1.2rem; text-align: center;" data-i18n="win_text">Congratulations! You won!</p>
      </div>
      <div class="modal-footer">
        <button class="action-btn primary" id="winModalClose" data-i18n="awesome">Awesome!</button>
      </div>
    </div>
  </div>

  <!-- Chat -->
  <div class="chat-container" id="chatContainer">
    <div class="chat-header" id="chatHeader">
      <h4 data-i18n="chat">Chat</h4>
      <button class="chat-toggle" id="chatToggle">‚àí</button>
    </div>
    <div class="chat-log" id="chatLog"></div>
    <div class="chat-input-container">
      <input type="text" class="chat-input" id="chatInput" data-i18n-placeholder="type_message" placeholder="Type a message..." maxlength="200" />
    </div>
  </div>

  <!-- Toast notifications -->
  <div id="toast-container" class="toast-container" role="region" aria-label="Notifications"></div>

  <!-- Event Log -->
  <div class="event-log" id="eventLog" role="log" aria-live="polite" aria-label="Recent events">
    <div style="font-weight: 600; margin-bottom: 8px; padding-bottom: 8px; border-bottom: 1px solid var(--border-color);" data-i18n="recent_events">Recent Events</div>
    <div id="eventLogItems"></div>
  </div>

  <!-- SVG Icons for Player Tokens (hidden, used via JS) -->
  <svg style="display: none;" id="tokenIcons">
    <defs>
      <!-- Hat -->
      <g id="token-hat">
        <path d="M12 4 L8 12 L16 12 Z" fill="currentColor" />
        <rect x="6" y="12" width="12" height="4" fill="currentColor" />
      </g>
      <!-- Car -->
      <g id="token-car">
        <rect x="4" y="8" width="16" height="8" rx="2" fill="currentColor" />
        <circle cx="8" cy="16" r="3" fill="currentColor" />
        <circle cx="16" cy="16" r="3" fill="currentColor" />
      </g>
      <!-- Dog -->
      <g id="token-dog">
        <circle cx="12" cy="10" r="6" fill="currentColor" />
        <circle cx="9" cy="8" r="2" fill="white" />
        <circle cx="15" cy="8" r="2" fill="white" />
        <ellipse cx="12" cy="12" rx="3" ry="2" fill="white" />
      </g>
      <!-- Iron -->
      <g id="token-iron">
        <path d="M8 6 L16 6 L14 18 L10 18 Z" fill="currentColor" />
        <rect x="11" y="4" width="2" height="4" fill="currentColor" />
      </g>
      <!-- Ship -->
      <g id="token-ship">
        <path d="M4 14 L20 14 L18 18 L6 18 Z" fill="currentColor" />
        <path d="M12 6 L16 14 L8 14 Z" fill="currentColor" />
      </g>
      <!-- Thimble -->
      <g id="token-thimble">
        <ellipse cx="12" cy="10" rx="6" ry="8" fill="currentColor" />
        <ellipse cx="12" cy="6" rx="4" ry="2" fill="currentColor" />
      </g>
    </defs>
  </svg>

  <script src="/socket.io/socket.io.js"></script>
  <script type="module" src="/js/client.js"></script>
  
  <script>
    // Fallback for non-module browsers
    if (!window.io) {
      document.body.innerHTML = '<div style="padding: 40px; text-align: center;"><h1>Error</h1><p>Socket.IO not loaded. Please refresh the page.</p></div>';
    }
  </script>
</body>
</html>
